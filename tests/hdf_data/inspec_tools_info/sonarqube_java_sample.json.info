{"buckets":{"failed":{"squid:S4347":{"vuln_num":"squid:S4347","rule_title":"\"SecureRandom\" seeds should not be predictable","vuln_discuss":"<p>The <code>java.security.SecureRandom</code> class provides a strong random number generator (RNG) appropriate for cryptography. However, seeding it\nwith a constant or another predictable value will weaken it significantly. In general, it is much safer to rely on the seed provided by the\n<code>SecureRandom</code> implementation.</p>\n<p>This rule raises an issue when <code>SecureRandom.setSeed()</code> or <code>SecureRandom(byte[])</code> are called with a seed that is either\nof:</p>\n<ul>\n  <li> a constant </li>\n  <li> <code>System.currentTimeMillis()</code> </li>\n</ul>\n<h2>Noncompliant Code Example</h2>\n<pre>\nSecureRandom sr = new SecureRandom();\nsr.setSeed(123456L); // Noncompliant\nint v = sr.next(32);\n\nsr = new SecureRandom(\"abcdefghijklmnop\".getBytes(\"us-ascii\")); // Noncompliant\nv = sr.next(32);\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\nSecureRandom sr = new SecureRandom();\nint v = sr.next(32);\n</pre>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration\">OWASP Top 10 2017 Category A6</a> - Security\n  Misconfiguration </li>\n  <li> <a href=\"http://cwe.mitre.org/data/definitions/330.html\">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>\n  <li> <a href=\"http://cwe.mitre.org/data/definitions/332.html\">MITRE, CWE-332</a> - Insufficient Entropy in PRNG </li>\n  <li> <a href=\"http://cwe.mitre.org/data/definitions/336.html\">MITRE, CWE-336</a> - Same Seed in Pseudo-Random Number Generator (PRNG) </li>\n  <li> <a href=\"http://cwe.mitre.org/data/definitions/337.html\">MITRE, CWE-337</a> - Predictable Seed in Pseudo-Random Number Generator (PRNG) </li>\n  <li> <a href=\"https://wiki.sei.cmu.edu/confluence/display/java/MSC63-J.+Ensure+that+SecureRandom+is+properly+seeded\">CERT, MSC63J.</a> - Ensure that\n  SecureRandom is properly seeded </li>\n</ul>","nist":"SC-13 Rev_4","impact":"0.7","profile_name":"SonarQube Scan","profile_shasum":"6f94b370ebaa414fda5a2a80575cc772e3d0cc58ce04adc6d74a61a48080c886","status":["failed"],"message":["FAILED -- Test: Path:heimdall:src/Random.java:10:10 StartLine: 7, EndLine: 13<br>Code:<pre>  {\n    SecureRandom sr = new SecureRandom();\n    sr.setSeed(123456L); // Noncompliant\n    System.out.println(sr.nextInt(32));\n  }\n}</pre>\nMessage: \n"],"compliance_status":"Open","finding_details":"One or more of the automated tests failed or was inconclusive for the control \n\n FAILED -- Test: Path:heimdall:src/Random.java:10:10 StartLine: 7, EndLine: 13<br>Code:<pre>  {\n    SecureRandom sr = new SecureRandom();\n    sr.setSeed(123456L); // Noncompliant\n    System.out.println(sr.nextInt(32));\n  }\n}</pre>\nMessage: \n"},"squid:ClassVariableVisibilityCheck":{"vuln_num":"squid:ClassVariableVisibilityCheck","rule_title":"Class variable fields should not have public accessibility","vuln_discuss":"<p>Public class variable fields do not respect the encapsulation principle and has three main disadvantages:</p>\n<ul>\n  <li> Additional behavior such as validation cannot be added. </li>\n  <li> The internal representation is exposed, and cannot be changed afterwards. </li>\n  <li> Member values are subject to change from anywhere in the code and may not meet the programmer's assumptions. </li>\n</ul>\n<p>By using private attributes and accessor methods (set and get), unauthorized modifications are prevented.</p>\n<h2>Noncompliant Code Example</h2>\n<pre>\npublic class MyClass {\n\n  public static final int SOME_CONSTANT = 0;     // Compliant - constants are not checked\n\n  public String firstName;                       // Noncompliant\n\n}\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\npublic class MyClass {\n\n  public static final int SOME_CONSTANT = 0;     // Compliant - constants are not checked\n\n  private String firstName;                      // Compliant\n\n  public String getFirstName() {\n    return firstName;\n  }\n\n  public void setFirstName(String firstName) {\n    this.firstName = firstName;\n  }\n\n}\n</pre>\n<h2>Exceptions</h2>\n<p>Because they are not modifiable, this rule ignores <code>public final</code> fields.</p>\n<h2>See</h2>\n<ul>\n  <li> <a href=\"http://cwe.mitre.org/data/definitions/493.html\">MITRE, CWE-493</a> - Critical Public Variable Without Final Modifier </li>\n</ul>","nist":"SI-11 Rev_4","impact":"0.3","profile_name":"SonarQube Scan","profile_shasum":"6f94b370ebaa414fda5a2a80575cc772e3d0cc58ce04adc6d74a61a48080c886","status":["failed"],"message":["FAILED -- Test: Path:heimdall:src/BadEnum.java:6:6 StartLine: 3, EndLine: 9<br>Code:<pre>  EUROPE (50, 39310000);\n\n  public int countryCount;  // Noncompliant\n  private int landMass;\n\n  Continent(int countryCount, int landMass) {\n    this.countryCount = countryCount;</pre>\nMessage: \n"],"compliance_status":"Open","finding_details":"One or more of the automated tests failed or was inconclusive for the control \n\n FAILED -- Test: Path:heimdall:src/BadEnum.java:6:6 StartLine: 3, EndLine: 9<br>Code:<pre>  EUROPE (50, 39310000);\n\n  public int countryCount;  // Noncompliant\n  private int landMass;\n\n  Continent(int countryCount, int landMass) {\n    this.countryCount = countryCount;</pre>\nMessage: \n"},"squid:S3066":{"vuln_num":"squid:S3066","rule_title":"\"enum\" fields should not be publicly mutable","vuln_discuss":"<p><code>enum</code>s are generally thought of as constant, but an <code>enum</code> with a <code>public</code> field or <code>public</code> setter is\nnot only non-constant, but also vulnerable to malicious code. Ideally fields in an <code>enum</code> are <code>private</code> and set in the\nconstructor, but if that's not possible, their visibility should be reduced as much as possible.</p>\n<h2>Noncompliant Code Example</h2>\n<pre>\npublic enum Continent {\n\n  NORTH_AMERICA (23, 24709000),\n  // ...\n  EUROPE (50, 39310000);\n\n  public int countryCount;  // Noncompliant\n  private int landMass;\n\n  Continent(int countryCount, int landMass) {\n    // ...\n  }\n\n  public void setLandMass(int landMass) {  // Noncompliant\n    this.landMass = landMass;\n  }\n</pre>\n<h2>Compliant Solution</h2>\n<pre>\npublic enum Continent {\n\n  NORTH_AMERICA (23, 24709000),\n  // ...\n  EUROPE (50, 39310000);\n\n  private int countryCount;\n  private int landMass;\n\n  Continent(int countryCount, int landMass) {\n    // ...\n  }\n</pre>","nist":"unmapped","impact":"0.3","profile_name":"SonarQube Scan","profile_shasum":"6f94b370ebaa414fda5a2a80575cc772e3d0cc58ce04adc6d74a61a48080c886","status":["failed"],"message":["FAILED -- Test: Path:heimdall:src/BadEnum.java:6:6 StartLine: 3, EndLine: 9<br>Code:<pre>  EUROPE (50, 39310000);\n\n  public int countryCount;  // Noncompliant\n  private int landMass;\n\n  Continent(int countryCount, int landMass) {\n    this.countryCount = countryCount;</pre>\nMessage: \n"],"compliance_status":"Open","finding_details":"One or more of the automated tests failed or was inconclusive for the control \n\n FAILED -- Test: Path:heimdall:src/BadEnum.java:6:6 StartLine: 3, EndLine: 9<br>Code:<pre>  EUROPE (50, 39310000);\n\n  public int countryCount;  // Noncompliant\n  private int landMass;\n\n  Continent(int countryCount, int landMass) {\n    this.countryCount = countryCount;</pre>\nMessage: \n"}},"passed":{},"no_impact":{},"skipped":{},"error":{}},"status":{"failed":{"total":3,"critical":0,"high":1,"medium":0,"low":2},"passed":{"total":0,"critical":0,"high":0,"medium":0,"low":0},"no_impact":{"total":0,"critical":0,"high":0,"medium":0,"low":0},"skipped":{"total":0,"critical":0,"high":0,"medium":0,"low":0},"error":{"total":0,"critical":0,"high":0,"medium":0,"low":0}},"compliance":0.0}