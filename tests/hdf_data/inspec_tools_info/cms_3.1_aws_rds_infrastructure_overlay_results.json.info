{"buckets":{"failed":{"aws-rds-baseline-1":{"vuln_num":"aws-rds-baseline-1","rule_title":"Ensure Databases running on RDS have encryption at rest enabled","vuln_discuss":"Amazon RDS instances and snapshots can be encrypted at rest by\n  enabling the encryption option on the Amazon RDS DB instance. Data that is\n  encrypted at rest includes the underlying storage for a DB instance, its\n  automated backups, read replicas, and snapshots. It is recommended that\n  encryption at rest be enabled.","nist":"SC-28 Rev_4","check_content":"Using the Amazon unified CLI:\n  * List all current RDS instances and review the encryption status of the\n  DB instance:\n\n  aws rds describe-db-instances --query 'DBInstances[*].{DBName:DBName,\n  EncryptionEnabled:StorageEncrypted, CMK:KmsKeyId}' ","fix_text":"Using the Amazon unified CLI:\n  * Perform a snapshot of the DB instance:\n\n  aws rds create-db-snapshot --db-snapshot-identifier <db_snapshot>\n  --db-instance- identifier <your_db_instance>\n\n  * Confirm created snapshot is available (once snapshot process has\n  completed):\n\n  aws rds describe-db-snapshots --query\n  'DBSnapshots[*].{DBSnapshotIdentifier:DBSnapshotIdentifier,\n  DBInstanceIdentifier:DBInstanceIdentifier, Snapshotstatus:Status}'\n\n  * List all KMS Customer Managed Keys: aws kms list-aliases\n\n  aws kms list-aliases\n\n  * Copy to source RDS snapshot (from previous step) to a destination snapshot\n  which will be encrypted:\n\n  aws rds copy-db-snapshot --source-db-snapshot-identifier <db_snapshot>\n  --target-db- snapshot-identifier <encrypted_db_snapshot>\n  --kms-key-id <data_tier_kms_key>\n\n  * Restore a snapshot to the target DB instance(from previous step) with same\n  values as original db instance with additional encrypted storage values:\n\n  aws rds restore-db-instance-from-db-snapshot --db-instance-identifier\n  <your_db_instance> --db-snapshot-identifier <encrypted_db_snapshot>\n\n","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["failed"],"message":["FAILED -- Test: RDS Instance test storage_encrypted should equal true\nMessage: \nexpected true\n     got false\n\n"],"compliance_status":"Open","finding_details":"One or more of the automated tests failed or was inconclusive for the control \n\n FAILED -- Test: RDS Instance test storage_encrypted should equal true\nMessage: \nexpected true\n     got false\n\n"},"aws-rds-baseline-10":{"vuln_num":"aws-rds-baseline-10","rule_title":"Ensure RDS Database is not publicly accessible.","vuln_discuss":"Amazon Relational Database Service (RDS) is a managed relational database\n  service which handles routine database tasks such as provisioning, patching,\n  backup, recovery, failure detection, and repair.\n  There are 6 database engines available for customer to run their database\n  workloads on:\n  * Amazon Aurora (MySQL Compatible)\n  * MySQL\n  * MariaDB\n  * Oracle\n  * Microsoft SQL Server\n  * PostgreSQL\n  Customers can deploy RDS databases within a VPC through the configuration of:\n  * Subnet Group for RDS, this group will be used for deployment of single or\n  Multi-AZ RDS instances.\n  * Network access through configuration of Security Groups for RDS\n  * Access from outside the VPC hosting the DB instance by enabling/disabling a\n  Public\n  IP address","nist":"SC-7 Rev_4","check_content":"Using the Amazon unified command line interface:\n  * Check if your application DB instances are publicly available:\n\n  aws rds describe-db-instances --filters\n  Name=tag:<data_tier_tag>,Values=<data_tier_tag_value> --query\n  'DBInstances[*].{PubliclyAccessible:PubliclyAccessible,\n  DBInstanceIdentifier:DBInstanceIdentifier}'\n  ","fix_text":"Using the Amazon unified command line interface:\n  * Modify each publicly accessible DB instance, and make it private:\n\n  aws rds modify-db-instance --db-instance-identifier <your_db_instance>\n  --no-publicly- accessible\n  ","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["failed"],"message":["FAILED -- Test: RDS Instance test publicly_accessible should not equal true\nMessage: \nexpected not #<TrueClass:20> => true\n         got #<TrueClass:20> => true\n\nCompared using equal?, which compares object identity.\n\n\n"],"compliance_status":"Open","finding_details":"One or more of the automated tests failed or was inconclusive for the control \n\n FAILED -- Test: RDS Instance test publicly_accessible should not equal true\nMessage: \nexpected not #<TrueClass:20> => true\n         got #<TrueClass:20> => true\n\nCompared using equal?, which compares object identity.\n\n\n"},"aws-rds-baseline-2":{"vuln_num":"aws-rds-baseline-2","rule_title":"Ensure Relational Database Service is Multi-AZ Enabled.","vuln_discuss":"Amazon Relational Database Service (RDS) is a managed relational database\n  service which handles routine database tasks such as provisioning, patching,\n  backup, recovery, failure detection, and repair.\n  There are 6 database engines available for customer to run their database\n  workloads on:\n  * Amazon Aurora (MySQL Compatible)\n  * MySQL\n  * MariaDB\n  * Oracle\n  * Microsoft SQL Server\n  * PostgreSQL","nist":"CM-6 Rev_4","check_content":"Using the Amazon unified command line interface:\n  * Check if your application DB instances are Multi-AZ enabled:\n\n  aws rds describe-db-instances --filters\n  Name=tag:<data_tier_tag>,Values=<data_tier_tag_value> --query\n  'DBInstances[*].{MultiAZ:MultiAZ, DBInstanceIdentifier:DBInstanceIdentifier}'\n  ","fix_text":"Using the Amazon unified command line interface:\n  * Modify each no-multi-az DB instance, and make it Multi-AZ enabled:\n  aws rds modify-db-instance --db-instance-identifier <your_db_instance>\n  --multi-az","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["failed"],"message":["FAILED -- Test: RDS Instance test multi_az should equal true\nMessage: \nexpected true\n     got false\n\n"],"compliance_status":"Open","finding_details":"One or more of the automated tests failed or was inconclusive for the control \n\n FAILED -- Test: RDS Instance test multi_az should equal true\nMessage: \nexpected true\n     got false\n\n"},"aws-rds-baseline-6":{"vuln_num":"aws-rds-baseline-6","rule_title":"Ensure RDS event subscriptions are enabled for Instance level events","vuln_discuss":"AWS Relational Database Services offers customers a managed database\n  engine solution for hosting customer created databases which can allow for a\n  reduction in operational burden on customers.\n  RDS event subscriptions provide notification of selected event changes at\n  DataBase engine level such as:\n    * Deletion\n    * Failure\n    * Failover\n    * Low Storage\n    * Maintenance","nist":"IR-6 Rev_4","check_content":"Using the Amazon unified CLI:\n  * List all present event subscriptions and review the value of 'db-instance'\n    associated with 'SourceType' element:\n\n    aws rds describe-event-subscriptions --query\n    'EventSubscriptionsList[*].{SourceType:SourceType, SourceIdsList:SourceIdsList,\n    EventCategoriesList:EventCategoriesList}'\n\n    * 'EventCategoriesList' will list all event categories which will be reported on\n    * 'SourceIdsList' will list all RDS DB instances included (null=all instances)\n    ","fix_text":"Using the Amazon unified CLI:\n  * Create a new event subscription for DB instance level events:\n    aws rds create-event-subscription --subscription-name <rds_event_subscription>\n    --sns- topic-arn <sns_topic_arn> --source-type db-instance --event-categories\n    <rds_events> -- source-ids <events_source_ids> --enabled\n  ","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["passed","failed","passed","failed","failed","failed","failed","failed","failed","passed","passed"],"message":["PASS -- DB-Instance Event Subscriptions should exist\n","FAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"all\"\nMessage: expected [\"recovery\", \"backup\"] to include \"all\"\n","PASS -- DB-Instance Event Subscriptions should exist\n","FAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"deletion\"\nMessage: expected [\"recovery\", \"backup\"] to include \"deletion\"\n","FAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"failure\"\nMessage: expected [\"recovery\", \"backup\"] to include \"failure\"\n","FAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"failover\"\nMessage: expected [\"recovery\", \"backup\"] to include \"failover\"\n","FAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"low storage\"\nMessage: expected [\"recovery\", \"backup\"] to include \"low storage\"\n","FAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"maintenance\"\nMessage: expected [\"recovery\", \"backup\"] to include \"maintenance\"\n","FAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"notification\"\nMessage: expected [\"recovery\", \"backup\"] to include \"notification\"\n","PASS -- DB-Instance Event Subscriptions should exist\n","PASS -- DB-Instance Event Subscriptions source_ids_lists.flatten should include \"all\"\n"],"compliance_status":"Open","finding_details":"One or more of the automated tests failed or was inconclusive for the control \n\n FAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"all\"\nMessage: expected [\"recovery\", \"backup\"] to include \"all\"\nFAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"deletion\"\nMessage: expected [\"recovery\", \"backup\"] to include \"deletion\"\nFAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"failover\"\nMessage: expected [\"recovery\", \"backup\"] to include \"failover\"\nFAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"failure\"\nMessage: expected [\"recovery\", \"backup\"] to include \"failure\"\nFAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"low storage\"\nMessage: expected [\"recovery\", \"backup\"] to include \"low storage\"\nFAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"maintenance\"\nMessage: expected [\"recovery\", \"backup\"] to include \"maintenance\"\nFAILED -- Test: DB-Instance Event Subscriptions event_categories_lists.flatten should include \"notification\"\nMessage: expected [\"recovery\", \"backup\"] to include \"notification\"\nPASS -- DB-Instance Event Subscriptions should exist\nPASS -- DB-Instance Event Subscriptions should exist\nPASS -- DB-Instance Event Subscriptions should exist\nPASS -- DB-Instance Event Subscriptions source_ids_lists.flatten should include \"all\"\n"},"aws-rds-baseline-7":{"vuln_num":"aws-rds-baseline-7","rule_title":" Ensure RDS event subscriptions are enabled for DB security groups.","vuln_discuss":"AWS Relational Database Services offers customers a managed database\n  engine solution for hosting customer created databases which can allow for a\n  reduction in operational burden on customers.\n  RDS event subscriptions provide notification of selected event changes at a DB\n  security group level","nist":"IR-6 Rev_4","check_content":"Using the Amazon unified CLI:\n  * List all present event subscriptions and review the value of\n  'db-security-group' associated with 'SourceType' element:\n\n  aws rds describe-event-subscriptions --query\n  'EventSubscriptionsList[*].{SourceType:SourceType,\n  SourceIdsList:SourceIdsList,\n  EventCategoriesList:EventCategoriesList}'\n\n  * 'EventCategoriesList' will list all event categories which will be reported\n  on\n  * 'SourceIdsList' will list all RDS DB instances included (null=all\n  instances)","fix_text":"Using the Amazon unified CLI:\n  * Create a new event subscription for DB Security Group events:\n  aws rds create-event-subscription --subscription-name <rds_event_subscription>\n  --sns- topic-arn <sns_topic_arn> --source-type db-security-group\n  --event-categories <rds_events> --source-ids <events_source_ids> --enabled\n  ","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["failed"],"message":["FAILED -- Test: DB Security Group Event Subscriptions event_categories_lists.flatten should not be empty\nMessage: expected `[].empty?` to return false, got true\n"],"compliance_status":"Open","finding_details":"One or more of the automated tests failed or was inconclusive for the control \n\n FAILED -- Test: DB Security Group Event Subscriptions event_categories_lists.flatten should not be empty\nMessage: expected `[].empty?` to return false, got true\n"},"aws-rds-baseline-8":{"vuln_num":"aws-rds-baseline-8","rule_title":"Create the Data tier Security Group and ensure it allows inbound\n  connections from App tier Security Group for explicit ports.","vuln_discuss":"A security group acts as a virtual firewall for your instance to control\n  inbound and outbound traffic. When you launch an instance in the AWS Virtual\n  Private Cloud (VPC), you can assign the instance to up to five security groups.\n  Security groups act at the instance level, not the subnet level. Therefore,\n  each instance in a subnet in your VPC could be assigned to a different set of\n  security groups. If you don't specify a particular group at launch time, the\n  instance is automatically assigned to the default security group for the VPC.\n  For each security group, you add rules that control the inbound traffic to\n  instances, and a separate set of rules that control the outbound traffic.\n  The port for these inbound rules would depend on the Database engine used and\n  the configured port.\n\n  The default values are:\n  MySQL - TCP 3306\n  MSSQL - TCP 1433\n  Oracle SQL - TCP 1521\n  PostgreSQL - TCP 5432\n  MariaDB - TCP 3306\n  Amazon Aurora DB - TCP 3306","nist":"SC-7 Rev_4","check_content":"Using the Amazon unified command line interface:\n  Using the Amazon unified command line interface:\n\n  * Retrieve the Data tier security group configured for your RDS DB instance:\n\n  aws rds describe-db-instances --db-instance-identifier <your_db_instance>\n  --query 'DBInstances[*].VpcSecurityGroups'\n\n  * List the ingress rules for the above security group, and make sure that\n  allows connections only from App tier security group on specific ports:\n\n  aws ec2 describe-security-groups --group-ids <data_tier_security_group> --query\n  'SecurityGroups[*].{GroupName:GroupName, IpPermissions:IpPermissions}' --output\n  table\n  ","fix_text":"Using the Amazon unified command line interface:\n\n  * First remove all the ingress rules for the security group configured for your\n  RDS DB instance:\n\n  aws ec2 describe-security-groups --group-id <data_tier_security_group> --query\n  'SecurityGroups[0].IpPermissions' > /tmp/IpPermissions.json\n  aws ec2 revoke-security-group-ingress --group-id <data_tier_security_group>\n  --ip- permissions file:///tmp/IpPermissions.json\n\n  * Add an ingress rule for a specific port, using --source-group option to\n  specify the App tier security group as the source of the connections:\n\n  aws ec2 authorize-security-group-ingress --group-id <data_tier_security_group>\n  -- protocol tcp --port <specific_port> --source-group <app_tier_security_group>'\n\n  ","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["failed","failed","failed","failed"],"message":["FAILED -- Test: EC2 Security Group sg-0328d77daf60e3d4c should allow in {:ipv4_range=>\"0.0.0.0/0\", :port=>3306}\nMessage: expected `EC2 Security Group sg-0328d77daf60e3d4c.allow_in?({:ipv4_range=>\"0.0.0.0/0\", :port=>3306})` to return true, got false\n","FAILED -- Test: EC2 Security Group sg-0328d77daf60e3d4c should allow in {:ipv4_range=>\"0.0.0.0/0\", :port=>1433}\nMessage: expected `EC2 Security Group sg-0328d77daf60e3d4c.allow_in?({:ipv4_range=>\"0.0.0.0/0\", :port=>1433})` to return true, got false\n","FAILED -- Test: EC2 Security Group sg-0328d77daf60e3d4c should allow in {:ipv4_range=>\"0.0.0.0/0\", :port=>1521}\nMessage: expected `EC2 Security Group sg-0328d77daf60e3d4c.allow_in?({:ipv4_range=>\"0.0.0.0/0\", :port=>1521})` to return true, got false\n","FAILED -- Test: EC2 Security Group sg-0328d77daf60e3d4c should allow in {:ipv4_range=>\"0.0.0.0/0\", :port=>5432}\nMessage: expected `EC2 Security Group sg-0328d77daf60e3d4c.allow_in?({:ipv4_range=>\"0.0.0.0/0\", :port=>5432})` to return true, got false\n"],"compliance_status":"Open","finding_details":"One or more of the automated tests failed or was inconclusive for the control \n\n FAILED -- Test: EC2 Security Group sg-0328d77daf60e3d4c should allow in {:ipv4_range=>\"0.0.0.0/0\", :port=>1433}\nMessage: expected `EC2 Security Group sg-0328d77daf60e3d4c.allow_in?({:ipv4_range=>\"0.0.0.0/0\", :port=>1433})` to return true, got false\nFAILED -- Test: EC2 Security Group sg-0328d77daf60e3d4c should allow in {:ipv4_range=>\"0.0.0.0/0\", :port=>1521}\nMessage: expected `EC2 Security Group sg-0328d77daf60e3d4c.allow_in?({:ipv4_range=>\"0.0.0.0/0\", :port=>1521})` to return true, got false\nFAILED -- Test: EC2 Security Group sg-0328d77daf60e3d4c should allow in {:ipv4_range=>\"0.0.0.0/0\", :port=>3306}\nMessage: expected `EC2 Security Group sg-0328d77daf60e3d4c.allow_in?({:ipv4_range=>\"0.0.0.0/0\", :port=>3306})` to return true, got false\nFAILED -- Test: EC2 Security Group sg-0328d77daf60e3d4c should allow in {:ipv4_range=>\"0.0.0.0/0\", :port=>5432}\nMessage: expected `EC2 Security Group sg-0328d77daf60e3d4c.allow_in?({:ipv4_range=>\"0.0.0.0/0\", :port=>5432})` to return true, got false\n"}},"passed":{"aws-rds-baseline-11":{"vuln_num":"aws-rds-baseline-11","rule_title":"Ensure RDS Database is configured to use the Data Tier Security Group","vuln_discuss":"Amazon Relational Database Service (RDS) is a managed relational database\n  service which handles routine database tasks such as provisioning, patching,\n  backup, recovery, failure detection, and repair.\n  There are 6 database engines available for customer to run their database\n  workloads on:\n  * Amazon Aurora (MySQL Compatible)\n  * MySQL\n  * MariaDB\n  * Oracle\n  * Microsoft SQL Server\n  * PostgreSQL\n  Customers can deploy RDS databases within a VPC through the configuration of:\n  * Subnet Group for RDS, this group will be used for deployment of single or\n  Multi-AZ RDS instances.\n  * Network access through configuration of Security Groups for RDS\n  * Access from outside the VPC hosting the DB instance by enabling/disabling a\n  Public\n  IP address","nist":"SC-7 Rev_4","check_content":"Using the Amazon unified command line interface:\n  * Check if your application DB instances are configured to use the Data Tier\n  Security Group:\n\n  aws rds describe-db-instances --filters\n  Name=tag:<data_tier_tag>,Values=<data_tier_tag_value> --query\n  'DBInstances[*].{VpcSecurityGroups:VpcSecurityGroups,s\n  DBInstanceIdentifier:DBInstanceIdentifier}'\n  ","fix_text":"Using the Amazon unified command line interface:\n  * Modify each non-compliant DB instance, and configure it to use the Data Tier\n  Security Group:\n\n  aws rds modify-db-instance --db-instance-identifier <your_db_instance>\n  --vpc-security- group-ids <data_tier_security_group>\n  ","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["passed"],"message":["PASS -- RDS Instance test vpc_security_group_id should be in \"sg-0328d77daf60e3d4c\"\n"],"compliance_status":"NotAFinding","finding_details":"All Automated tests passed for the control \n\n PASS -- RDS Instance test vpc_security_group_id should be in \"sg-0328d77daf60e3d4c\"\n"},"aws-rds-baseline-3":{"vuln_num":"aws-rds-baseline-3","rule_title":"Ensure Relational Database Service Instances have Auto Minor Version\n  Upgrade Enabled.","vuln_discuss":"Amazon Relational Database Service (RDS) is a managed relational database\n  service which handles routine database tasks such as provisioning, patching,\n  backup, recovery, failure detection, and repair.\n  There are 6 database engines available for customer to run their database\n  workloads on:\n  * Amazon Aurora (MySQL Compatible)\n  * MySQL\n  * MariaDB\n  * Oracle\n  * Microsoft SQL Server\n  * PostgreSQL\n  If the database engine used by your application supports it, ensure that the\n  RDS Instances have Auto Minor Version Upgrade Enabled.","nist":"CM-6 Rev_4","check_content":"Using the Amazon unified command line interface:\n  * Check if your application DB instances have Auto Minor Version Upgrade\n  enabled:\n\n  aws rds describe-db-instances --filters\n  Name=tag:<data_tier_tag>,Values=<data_tier_tag_value> --query\n  'DBInstances[*].{AutoMinorVersionUpgrade:AutoMinorVersionUpgrade,\n  DBInstanceIdentifier:DBInstanceIdentifier}'\n  ","fix_text":"Using the Amazon unified command line interface:\n  * Modify each DB instance with auto-minor-version-upgrade set to False, and\n  enable auto-minor-version-upgrade:\n\n  aws rds modify-db-instance --db-instance-identifier <your_db_instance>\n  --auto-minor- version-upgrade","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["passed"],"message":["PASS -- RDS Instance test auto_minor_version_upgrade should equal true\n"],"compliance_status":"NotAFinding","finding_details":"All Automated tests passed for the control \n\n PASS -- RDS Instance test auto_minor_version_upgrade should equal true\n"},"aws-rds-baseline-4":{"vuln_num":"aws-rds-baseline-4","rule_title":"Ensure Relational Database Service backup retention policy is set.","vuln_discuss":"Amazon Relational Database Service (RDS) is a managed relational database\n  service which handles routine database tasks such as provisioning, patching,\n  backup, recovery, failure detection, and repair.\n  There are 6 database engines available for customer to run their database\n  workloads on:\n  * Amazon Aurora (MySQL Compatible)\n  * MySQL\n  * MariaDB\n  * Oracle\n  * Microsoft SQL Server\n  * PostgreSQL.","nist":"CP-9 Rev_4","check_content":"Using the Amazon unified command line interface:\n  * Check if your application DB instances have a Backup Retention Period set (0\n  = there is no backup retention in place, 7 = there are 7 daily backups\n  retained):\n\n  aws rds describe-db-instances --filters\n  Name=tag:<data_tier_tag>,Values=<data_tier_tag_value> --query\n  'DBInstances[*].{BackupRetentionPeriod:BackupRetentionPeriod,\n  DBInstanceIdentifier:DBInstanceIdentifier}'\n  ","fix_text":"Using the Amazon unified command line interface:\n  * Modify each DB instance with Backup Retention Period of 0, and set a desired\n  Backup Retention Period in days (recommended value = 7):\n\n  aws rds modify-db-instance --db-instance-identifier <your_db_instance>\n  --backup- retention-period <backup_retention_period>","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["passed"],"message":["PASS -- RDS Instance test backup_retention_period should cmp >= 7\n"],"compliance_status":"NotAFinding","finding_details":"All Automated tests passed for the control \n\n PASS -- RDS Instance test backup_retention_period should cmp >= 7\n"},"aws-rds-baseline-5":{"vuln_num":"aws-rds-baseline-5","rule_title":" Ensure a SNS topic is created for sending out notifications from RDS\n  events.","vuln_discuss":"For the RDS event subscriptions to be able to send out notifications, a\n  SNS topic should be created.\n  Amazon Simple Notification Service (Amazon SNS) is a web service that\n  coordinates and manages the delivery or sending of messages to subscribing\n  endpoints or clients.\n  When using Amazon SNS, you (as the owner) create a topic and control access to\n  it by defining policies that determine which publishers and subscribers can\n  communicate with the topic.","nist":"CM-6 Rev_4","check_content":"Using the Amazon unified CLI:\n  * List all RDS event subscriptions in order to capture the topic-arn:\n\n  aws rds describe-event-subscriptions --query\n  'EventSubscriptionsList[*].{SourceType:SourceType,\n  SourceIdsList:SourceIdsList,\n  EventCategoriesList:EventCategoriesList}'\n\n  * List SNS topic attributes:\n\n  aws sns list-topic-attributes --topic-arn <sns_topic_arn>\n\n  * List SNS topic subscriptions (endpoint which receives messages captured by\n  the SNS topic):\n\n  aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>\n  ","fix_text":"Using the Amazon unified CLI:\n\n  * Create a new topic, and note the topic-arn value:\n\n  aws sns create-topic --name <sns_topic_name>\n\n  * Create a subscription to the new topic:\n\n  aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --\n  notification-endpoint <sns_subscription_endpoints>\n  ","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["passed","passed"],"message":["PASS -- AWS RDS Event Subscriptions event_subscription_arns should not be empty\n","PASS -- AWS RDS Event Subscriptions source_types should not be empty\n"],"compliance_status":"NotAFinding","finding_details":"All Automated tests passed for the control \n\n PASS -- AWS RDS Event Subscriptions event_subscription_arns should not be empty\nPASS -- AWS RDS Event Subscriptions source_types should not be empty\n"},"aws-rds-baseline-9":{"vuln_num":"aws-rds-baseline-9","rule_title":"Ensure Data tier Security Group has no inbound rules for CIDR of 0\n  (Global Allow).","vuln_discuss":"A security group acts as a virtual firewall for your instance to control\n  inbound and outbound traffic. When you launch an instance in the AWS Virtual\n  Private Cloud (VPC), you can assign the instance to up to five security groups.\n  Security groups act at the instance level, not the subnet level. Therefore,\n  each instance in a subnet in your VPC could be assigned to a different set of\n  security groups. If you don't specify a particular group at launch time, the\n  instance is automatically assigned to the default security group for the VPC.\n  For each security group, you add rules that control the inbound traffic to\n  instances, and a separate set of rules that control the outbound traffic.","nist":"SC-7 Rev_4","check_content":"Using the Amazon unified command line interface:\n  Using the Amazon unified command line interface:\n\n  * Retrieve the Data tier security group configured for your RDS DB instance:\n\n  aws rds describe-db-instances --db-instance-identifier <your_db_instance>\n\n  * List the ingress rules for the above security group, and make sure it has no\n  inbound rules for CIDR of 0.0.0.0/0:\n\n  aws ec2 describe-security-groups --group-ids <data_tier_security_group> --query\n  'SecurityGroups[*].{GroupName:GroupName, IpPermissions:IpPermissions}' --output\n  table\n  ","fix_text":"Using the Amazon unified command line interface:\n\n  * Remove the ingress rules for CIDR 0.0.0.0/0:\n  aws ec2 revoke-security-group-ingress --group-id <data_tier_security_group>\n  --protocol tcp/udp --port <specific_port> --cidr 0.0.0.0/0\n  ","impact":"0.3","profile_name":"aws-rds-infrastructure-cis-baseline","profile_shasum":"032cc588f9de880bf27bd30663cfe8731948dde1e0d3e29a0d1b961449c9916d","status":["passed"],"message":["PASS -- EC2 Security Group sg-0328d77daf60e3d4c should not allow in {:ipv4_range=>\"0.0.0.0/0\"}\n"],"compliance_status":"NotAFinding","finding_details":"All Automated tests passed for the control \n\n PASS -- EC2 Security Group sg-0328d77daf60e3d4c should not allow in {:ipv4_range=>\"0.0.0.0/0\"}\n"}},"no_impact":{},"skipped":{},"error":{}},"status":{"failed":{"total":6,"critical":0,"high":0,"medium":0,"low":6},"passed":{"total":5,"critical":0,"high":0,"medium":0,"low":5},"no_impact":{"total":0,"critical":0,"high":0,"medium":0,"low":0},"skipped":{"total":0,"critical":0,"high":0,"medium":0,"low":0},"error":{"total":0,"critical":0,"high":0,"medium":0,"low":0}},"compliance":45.5}